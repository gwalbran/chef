# OceanCurrent definitions
#
# Autogenerated by Chef.

<%
@nodes.each do |n|
  host_name = node['nagios']['server']['normalize_hostname'] ? n[node['nagios']['host_name_attribute']].downcase : n[node['nagios']['host_name_attribute']]
  # find remotely synced hosts
  if n['nagios'] && n['nagios']['remote_sync_data_bags']
    n['nagios']['remote_sync_data_bags'].each do |remote_sync_name|
%>
define service {
  service_description remote_sync_<%= remote_sync_name %>
  check_command check_remote_sync_<%= remote_sync_name %>
  host_name <%= host_name %>
  use default-service
  servicegroups remote_sync
}

define command {
  command_name    check_remote_sync_<%= remote_sync_name %>
  command_line    $USER1$/check_nrpe -H $HOSTADDRESS$ -c check_remote_sync_<%= remote_sync_name %> -t 20
}

<%
    end
  end
end
%>

