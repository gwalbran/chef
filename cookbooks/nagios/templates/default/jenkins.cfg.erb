# vsftpd definitions
#
# Autogenerated by Chef.

<% current_host_name = node['nagios']['server']['normalize_hostname'] ? node[node['nagios']['host_name_attribute']].downcase : node[node['nagios']['host_name_attribute']] -%>
<%
@nodes.uniq.each do |n|
  host_name = node['nagios']['server']['normalize_hostname'] ? n[node['nagios']['host_name_attribute']].downcase : n[node['nagios']['host_name_attribute']]
  if n['run_list'].include?("recipe[imos_jenkins::managed_master]")
    jenkins_url = n['imos_jenkins']['master_url']
    n['imos_jenkins']['monitored_jobs'].each do |job|
%>
define service {
  service_description jenkins <%= job %>
  host_name <%= host_name %>
  check_command check_jenkins!<%= jenkins_url %>!<%= job %>
  servicegroups jenkins
  use default-service
}
<%
    end
  end
end
%>
