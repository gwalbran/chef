# vsftpd definitions
#
# Autogenerated by Chef.

<% current_host_name = node['nagios']['server']['normalize_hostname'] ? node[node['nagios']['host_name_attribute']].downcase : node[node['nagios']['host_name_attribute']] -%>
<%
@nodes.uniq.each do |n|
  host_name = node['nagios']['server']['normalize_hostname'] ? n[node['nagios']['host_name_attribute']].downcase : n[node['nagios']['host_name_attribute']]
  if n['run_list'].include?("ftp_server")
%>
define service {
  service_description vsftpd directory permissions
  host_name <%= host_name %>
  check_command check_ftp_dirs
  servicegroups vsftpd
  use default-service
}
<%
  end
end
%>

define command {
        command_name    check_ftp_dirs
        command_line    $USER1$/check_nrpe -H $HOSTADDRESS$ -c check_ftp_dirs -t 20
}
