# Autogenerated by Chef.
<% @instances.each do |instance_params| %>

input {
  file {
    path => "<%= File.join(node['tomcat']['base'], instance_params['name'], 'logs', 'catalina.out') %>"
    codec => json
    tags => [ "webapp", "<%= instance_params['name'] %>"]
    type => "webapp_<%= instance_params['name'] %>"
  }
}

filter {

  if [type] == "webapp_<%= instance_params['name'] %>" {

    # App specific filters.
    <%
       instance_params['apps'].each do |app_params|
         app_data_bag = Chef::DataBagItem.load("imos_artifacts", app_params['artifact'])
         if app_data_bag['logstash_filter_config']
    %>
<%= render "config/filters_#{app_data_bag['logstash_filter_config']}.conf.erb" %>
    <%
         end
       end
    %>
  }
}

<% end %>
