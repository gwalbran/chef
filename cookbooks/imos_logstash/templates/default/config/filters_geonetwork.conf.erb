date {
  match => [ "timestamp" , "ISO8601" ]
}

multiline {
  pattern => "<%= node['imos_logstash']['agent']['loglevels'].join('|') %>"
  negate => true
  what => "previous"
}

grok {
  match => [
    "message", "%{TIMESTAMP_ISO8601:timestamp} %{LOGLEVEL:level}%{SPACE}\[%{NOTSPACE:class}\] - %{GREEDYDATA:log_message}"
  ]
  break_on_match => false
}
