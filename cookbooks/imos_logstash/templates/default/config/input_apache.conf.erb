# Autogenerated by Chef.
input {
  file {
    path => "<%= @path %>"
    codec => json
    tags => [ "apache" ]
    type => "apache"
  }
}

filter {
  if [type] == "apache" {

    grok {
      match => { "message" => "%{COMBINEDAPACHELOG}" }
      break_on_match => false
    }

    date {
      match => [ "timestamp" , "dd/MMM/yyyy:HH:mm:ss Z" ]
    }

    # Uncomment this to test - private IPs, such as those used by VirtualBox, are not in the
    # geoip database, and so the geoip filter below won't be able to add any geo attributes
    # to the event.
    # mutate {
    #   replace => [ "clientip", "131.217.38.8" ]
    # }
    geoip {
      source => "clientip"
    }
  }
}
