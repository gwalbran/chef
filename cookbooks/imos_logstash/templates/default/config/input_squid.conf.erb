# Autogenerated by Chef.

input {
  file {
    path => "<%= File.join(node['squid']['log_dir'], 'access.log') %>"
    codec => json
    tags => [ "squid" ]
    type => "squid"
  }
}

filter {

  if [type] == "squid" {
    date {
      match => [ "timestamp" , "UNIX" ]
    }

    grok {
      match => [
        "message", "%{NUMBER:timestamp}%{SPACE}%{NUMBER:request_msec:float} %{IPORHOST:src_ip} %{WORD:cache_result}/%{NUMBER:response_status:int} %{NUMBER:response_size:int} %{WORD:http_method} %{URI:uri} %{USERNAME:cache_user} %{WORD:request_route}/(%{IPORHOST:forwarded_to}|-) %{GREEDYDATA:content_type}"
      ]
      break_on_match => false
    }
  }

}
